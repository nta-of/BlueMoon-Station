<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/controller/subsystem/mail - Space Station 13</title></head><body><header><a href="index.html">Space Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/controller/subsystem/mail.html#var">Var Details</a> - <a href="datum/controller/subsystem/mail.html#proc">Proc Details</a></header><main><h1>mail <aside>/<a href="datum.html">datum</a>/<a href="datum/controller/subsystem.html">controller/subsystem</a>/<a href="datum/controller/subsystem/mail.html">mail</a></aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L1"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 1"></a></h1><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/all_patterns">all_patterns</a></th><td>Assoc list: pattern_name = pattern_object with all patterns, used in admin panel. Initialized in SSmail init.</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/all_patterns_by_category">all_patterns_by_category</a></th><td>Assoc list of all patterns by categories, initialized in SSmail/Initialize() proc</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/all_patterns_info">all_patterns_info</a></th><td>Assoc list: pattern_name = pattern_info_list with info about all patterns, used in admin panel. Initialized in SSmail init.</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/mail_categories_with_colors">mail_categories_with_colors</a></th><td>Assoc list 'mail category' = 'mail category color'</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/mail_categories_with_names">mail_categories_with_names</a></th><td>Assoc list 'mail category' = 'mail category name'. Used in admin panel</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/mail_categories_with_weights">mail_categories_with_weights</a></th><td>Assoc list 'mail category' = 'mail category weight'</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/mail_waiting">mail_waiting</a></th><td>Count of mails, created by SSmail in main storage, waiting to be sent to station. Nullifies when storage was sent.</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/main_storage">main_storage</a></th><td>Main storage of SSmail, where mails are created</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/main_storage_spawnpoint">main_storage_spawnpoint</a></th><td>Turf, where main mail storage of SSmail will be spawned</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/sealed_mails">sealed_mails</a></th><td>Mails on station, which was not opened yet</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#var/total_mails_count">total_mails_count</a></th><td>Total amount of arrived letters during the round</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/category_colorize">category_colorize</a></th><td>Converts subsystem to color</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/category_to_text">category_to_text</a></th><td>Converts subsystem to readable text</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/choose_pattern">choose_pattern</a></th><td>Choosing mail pattern for specific recipient in accordance to all weights</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/create_mail_for_recipient">create_mail_for_recipient</a></th><td>Creates a mail for a specific recipient</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/create_main_storage">create_main_storage</a></th><td>Creates new main_storage on specific turf</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/delete_obsolete_mails">delete_obsolete_mails</a></th><td>Deleting mails from sealed_mails list, which lifetime was expired, calling their mail/disappear() proc</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/generate_mails">generate_mails</a></th><td>Generate 'mail_gen_count' number of mails for random valid recipients in main_storage</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/parse_weights_to_html">parse_weights_to_html</a></th><td>Creates beatiful (maybe) HTML string from weights_assoc_list for debugging</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/regenerate_all_weights">regenerate_all_weights</a></th><td>Returns 'pattern type = modified weight' assoc list for specific recipient.
If you want zero-chance patterns to be included in list, use include_zeros. Used in adminpanel.
Filtering goes for specific categories, category or list of them passed in the 'categories' parameter.
If 'MAIL_ALL_CATEGORIES' parameter was selected search goes for all categories
Modification of weight for specific pattern can be specified in switch-case construction in this proc
This modification can filter out incompatible (cookies for synths) patterns or take in accout recipient's prefs</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/register_mail">register_mail</a></th><td>Registers mail, adding it to general list, where it will be destroyed in MAIL_DISAPPEAR_TIME if not opened</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/send_storage">send_storage</a></th><td>Sends storage to cargo shuttle and creating new</td></tr><tr><th><a href="datum/controller/subsystem/mail.html#proc/unregister_mail">unregister_mail</a></th><td>Unregister mail, removing it from lists</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/all_patterns"><aside class="declaration">var </aside>all_patterns <aside>– /static/list</aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L62"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 62"></a></h3><p>Assoc list: pattern_name = pattern_object with all patterns, used in admin panel. Initialized in SSmail init.</p><h3 id="var/all_patterns_by_category"><aside class="declaration">var </aside>all_patterns_by_category <aside>– /static/list</aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L56"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 56"></a></h3><p>Assoc list of all patterns by categories, initialized in SSmail/Initialize() proc</p><h3 id="var/all_patterns_info"><aside class="declaration">var </aside>all_patterns_info <aside>– /static/list</aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L59"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 59"></a></h3><p>Assoc list: pattern_name = pattern_info_list with info about all patterns, used in admin panel. Initialized in SSmail init.</p><h3 id="var/mail_categories_with_colors"><aside class="declaration">var </aside>mail_categories_with_colors <aside>– /static/list</aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L33"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 33"></a></h3><p>Assoc list 'mail category' = 'mail category color'</p><h3 id="var/mail_categories_with_names"><aside class="declaration">var </aside>mail_categories_with_names <aside>– /static/list</aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L44"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 44"></a></h3><p>Assoc list 'mail category' = 'mail category name'. Used in admin panel</p><h3 id="var/mail_categories_with_weights"><aside class="declaration">var </aside>mail_categories_with_weights <aside>– /static/list</aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L22"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 22"></a></h3><p>Assoc list 'mail category' = 'mail category weight'</p><h3 id="var/mail_waiting"><aside class="declaration">var </aside>mail_waiting <aside>– </aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L14"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 14"></a></h3><p>Count of mails, created by SSmail in main storage, waiting to be sent to station. Nullifies when storage was sent.</p><h3 id="var/main_storage"><aside class="declaration">var </aside>main_storage <aside>– /<a href="obj.html">obj</a>/<a href="obj/structure/closet.html">structure/closet</a>/<a href="obj/structure/closet/crate/mail.html">crate/mail</a></aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L16"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 16"></a></h3><p>Main storage of SSmail, where mails are created</p><h3 id="var/main_storage_spawnpoint"><aside class="declaration">var </aside>main_storage_spawnpoint <aside>– /<a href="turf.html">turf</a></aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L18"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 18"></a></h3><p>Turf, where main mail storage of SSmail will be spawned</p><h3 id="var/sealed_mails"><aside class="declaration">var </aside>sealed_mails <aside>– /list/obj/item/mail</aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L9"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 9"></a></h3><p>Mails on station, which was not opened yet</p><h3 id="var/total_mails_count"><aside class="declaration">var </aside>total_mails_count <aside>– </aside> <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L11"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 11"></a></h3><p>Total amount of arrived letters during the round</p><h2 id="proc">Proc Details</h2><h3 id="proc/category_colorize"><aside class="declaration">proc </aside>category_colorize<aside>(category)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L313"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 313"></a></aside></h3><p>Converts subsystem to color</p><h3 id="proc/category_to_text"><aside class="declaration">proc </aside>category_to_text<aside>(category)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L317"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 317"></a></aside></h3><p>Converts subsystem to readable text</p><h3 id="proc/choose_pattern"><aside class="declaration">proc </aside>choose_pattern<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/recipient)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L241"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 241"></a></aside></h3><p>Choosing mail pattern for specific recipient in accordance to all weights</p><h3 id="proc/create_mail_for_recipient"><aside class="declaration">proc </aside>create_mail_for_recipient<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/recipient, /<a href="atom.html">atom</a>/mail_holder, /<a href="datum.html">datum</a>/<a href="datum/mail_pattern.html">mail_pattern</a>/pattern, add_to_waiting_mails)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L202"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 202"></a></aside></h3><p>Creates a mail for a specific recipient</p><h3 id="proc/create_main_storage"><aside class="declaration">proc </aside>create_main_storage<aside>()  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L321"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 321"></a></aside></h3><p>Creates new main_storage on specific turf</p><h3 id="proc/delete_obsolete_mails"><aside class="declaration">proc </aside>delete_obsolete_mails<aside>()  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L164"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 164"></a></aside></h3><p>Deleting mails from sealed_mails list, which lifetime was expired, calling their mail/disappear() proc</p><h3 id="proc/generate_mails"><aside class="declaration">proc </aside>generate_mails<aside>(mail_gen_count)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L176"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 176"></a></aside></h3><p>Generate 'mail_gen_count' number of mails for random valid recipients in main_storage</p><h3 id="proc/parse_weights_to_html"><aside class="declaration">proc </aside>parse_weights_to_html<aside>(/list/weights_assoc_list)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L293"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 293"></a></aside></h3><p>Creates beatiful (maybe) HTML string from weights_assoc_list for debugging</p><h3 id="proc/regenerate_all_weights"><aside class="declaration">proc </aside>regenerate_all_weights<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/<a href="mob/living/carbon/human.html">human</a>/recipient, categories, include_zeros)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L267"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 267"></a></aside></h3><p>Returns 'pattern type = modified weight' assoc list for specific recipient.
If you want zero-chance patterns to be included in list, use include_zeros. Used in adminpanel.
Filtering goes for specific categories, category or list of them passed in the 'categories' parameter.
If 'MAIL_ALL_CATEGORIES' parameter was selected search goes for all categories
Modification of weight for specific pattern can be specified in switch-case construction in this proc
This modification can filter out incompatible (cookies for synths) patterns or take in accout recipient's prefs</p><h3 id="proc/register_mail"><aside class="declaration">proc </aside>register_mail<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/mail)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L154"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 154"></a></aside></h3><p>Registers mail, adding it to general list, where it will be destroyed in MAIL_DISAPPEAR_TIME if not opened</p><h3 id="proc/send_storage"><aside class="declaration">proc </aside>send_storage<aside>(/<a href="turf.html">turf</a>/destination)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L343"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 343"></a></aside></h3><p>Sends storage to cargo shuttle and creating new</p><h3 id="proc/unregister_mail"><aside class="declaration">proc </aside>unregister_mail<aside>(/<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/mail)  <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/blob/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8/code/controllers/subsystem/mail.dm#L158"><img src="git.png" width="16" height="16" title="code/controllers/subsystem/mail.dm 158"></a></aside></h3><p>Unregister mail, removing it from lists</p></main><footer>tgstation.dme <a href="https://github.com/BlueMoon-Labs/BlueMoon-Station/tree/d9a18b0d5a3596f8bb07aa7e12327525f51c6fe8">d9a18b0</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.9.0</a></footer></body></html>